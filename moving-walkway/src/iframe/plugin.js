(function () {
	'use strict';

	var Logger=function(){function n(){}return n.init=function(o){n._plugin=o;},n.log=function(o){n._plugin.broadcastMessage("log",o);},n.error=function(o){n._plugin.broadcastMessage("error",o);},n}();

	var Direction,__extends=this&&this.__extends||function(){var t=function(i,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i;}||function(t,i){for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);},t(i,e)};return function(i,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=i;}t(i,e),i.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r);}}();!function(t){t[t.up=0]="up",t[t.right=1]="right",t[t.down=2]="down",t[t.left=3]="left";}(Direction||(Direction={}));var Plugin=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i._iframeInfo=null,i._direction=null,i}return __extends(i,t),i.prototype.onLoad=function(t,i){Logger.init(this);try{if(!i.isLocal)throw new Error("Global not supported");this._iframeInfo=i.iframe,t&&(this._direction=t.direction);}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},i.prototype.onMessage=function(t,i){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];try{if("checkShouldSetup"===i)null===this._direction&&this.broadcastMessage("setup");else if("setDirection"===i){var o=e[0];Number.isInteger(o)&&o<=3&&0<=o&&(this._direction=o,this.broadcastMessage("setDirection",this._direction),this.saveData({direction:o}));}else"getDirection"===i&&null!==this._direction&&this.broadcastMessage("setDirection",this._direction);}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},i.prototype.onPlayerMove=function(t,i,e){try{if(null===this._iframeInfo)return;if(null===this._direction)return;this._iframeInfo.x<=i&&i<this._iframeInfo.x+this._iframeInfo.width&&this._iframeInfo.y<=e&&e<this._iframeInfo.y+this._iframeInfo.height&&(this._direction===Direction.up?this.requestMovePlayer(t,i,this._iframeInfo.y+this._iframeInfo.height):this._direction===Direction.right?this.requestMovePlayer(t,this._iframeInfo.x+this._iframeInfo.width,e):this._direction===Direction.down?this.requestMovePlayer(t,i,this._iframeInfo.y-1):this._direction===Direction.left&&this.requestMovePlayer(t,this._iframeInfo.x-1,e));}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},i.prototype.onUnload=function(){try{this._iframeInfo=null,this._direction=null;}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},i}(BasePlugin);globalThis.PluginImpl=Plugin;

}());
