(function () {
	'use strict';

	var Logger=function(){function n(){}return n.init=function(o){n._plugin=o;},n.log=function(o){n._plugin.broadcastMessage("log",o);},n.error=function(o){n._plugin.broadcastMessage("error",o);},n}();

	var OX,__extends=this&&this.__extends||function(){var t=function(o,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o;}||function(t,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);},t(o,n)};return function(o,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=o;}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e);}}();!function(t){t[t.O=1]="O",t[t.X=0]="X";}(OX||(OX={}));var Plugin=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o._iframeInfo=null,o._players=new Map,o.judge_x=0,o.question="",o.playing=!1,o.answer=OX.X,o}return __extends(o,t),o.prototype._broadcastPublicInfomation=function(){this.broadcastMessage("pub_state",this.question,this.playing);},o.prototype._broadcastPrivateInfomation=function(){this.broadcastMessage("priv_state",this.question,this.playing,this.answer);},o.prototype.onLoad=function(t,o){Logger.init(this);try{if(!o.isLocal)throw new Error("Global not supported");this._iframeInfo=o.iframe,this.judge_x=this._iframeInfo.x+this._iframeInfo.width/2;}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},o.prototype.onPlayerJoin=function(t){try{var o=987654321,n=987654321;this._iframeInfo&&(o=this._iframeInfo.x+1,n=this._iframeInfo.y+1),this._players.set(t,[o,n]);}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},o.prototype.onPlayerLeave=function(t){try{this._players.delete(t);}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},o.prototype.onPlayerMove=function(t,o,n){this._players.set(t,[o,n]);},o.prototype._judge=function(){var t=this;if(null!==this._iframeInfo){var o=this._iframeInfo;this._players.forEach((function(n,e){var i=n[0],r=n[1];o.x<=i&&i<o.x+o.width&&o.y<=r&&r<o.y+o.height&&((i>=t.judge_x?OX.X:OX.O)!==t.answer&&t.teleportPlayer(e,o.x+o.width+1,o.y+o.height-2));}));}},o.prototype.onChat=function(t,o){if(this.isAdmin(t)){if(/정답:(O|X)/gi.test(o)){this.playing=!1;var n=o.slice(3);return this.answer="O"===n[0]?OX.O:OX.X,this._judge(),void this._broadcastPrivateInfomation()}if(/문제:+./gi.test(o)){this.playing=!0;var e=o.slice(3);this.question=e;}this._broadcastPublicInfomation();}},o}(BasePlugin);globalThis.PluginImpl=Plugin;

}());
