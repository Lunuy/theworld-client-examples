(function () {
	'use strict';

	var Logger=function(){function n(){}return n.init=function(o){n._plugin=o;},n.log=function(o){n._plugin.broadcastMessage("log",o);},n.error=function(o){n._plugin.broadcastMessage("error",o);},n}();

	var OX,__extends=this&&this.__extends||function(){var t=function(o,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o;}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e]);},t(o,e)};return function(o,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=o;}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n);}}();!function(t){t[t.O=1]="O",t[t.X=0]="X";}(OX||(OX={}));var Plugin=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o._iframeInfo=null,o._players=new Map,o.judge_x=0,o.question="",o.playing=!1,o.answer=OX.X,o}return __extends(o,t),o.prototype._broadcastPublicInfomation=function(){this.broadcastMessage("pub_state",this.question,this.playing);},o.prototype._broadcastPrivateInfomation=function(){this.broadcastMessage("priv_state",this.question,this.playing,this.answer);},o.prototype.onLoad=function(t,o){Logger.init(this);try{if(!o.isLocal)throw new Error("Global not supported");this._iframeInfo=o.iframe,this.judge_x=this._iframeInfo.x+this._iframeInfo.width/2;}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},o.prototype.onPlayerJoin=function(t){try{var o=987654321,e=987654321;this._iframeInfo&&(o=this._iframeInfo.x+1,e=this._iframeInfo.y+1),this._players.set(t,[o,e]);}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},o.prototype.onPlayerLeave=function(t){try{this._players.delete(t);}catch(t){Logger.error("".concat(t.message,"\n").concat(t.stack));}},o.prototype.onPlayerMove=function(t,o,e){this._players.set(t,[o,e]);},o.prototype._judge=function(){var t=this;if(null!==this._iframeInfo){var o=this._iframeInfo;this._players.forEach((function(e,n){var i=e[0],r=e[1];o.x<=i&&i<o.x+o.width&&o.y<=r&&r<o.y+o.height&&((i>=t.judge_x?OX.X:OX.O)!==t.answer&&t.teleportPlayer(n,o.x+o.width+1,o.y+o.height-2));}));}},o.prototype.onChat=function(t,o){if(this.isAdmin(t)){if(/정답:(O|X)/gi.test(o)){this.playing=!1;var e=o.slice(3);return this.answer="o"===e[0].toLowerCase()?OX.O:OX.X,this._judge(),void this._broadcastPrivateInfomation()}if(/문제:+./gi.test(o)){this.playing=!0;var n=o.slice(3);this.question=n;}this._broadcastPublicInfomation();}},o}(BasePlugin);globalThis.PluginImpl=Plugin;

}());
